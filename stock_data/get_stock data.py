
#greeting
print "Script written by Ryan Lee July 2013"
print "Gets stock historical data"
print "================================================"

#import necessary libraries
import urllib 
import datetime
import csv
from multiprocessing import Pool

#init
#genes = ["BBDO", "MU", "DLR", "AU", "GFI", "OIBR-C", "PTEN", "SFUN", "RDN", "HMSY", "PDH", "CSTM", "CLDX", "ALDW", "INFN", "CROX", "HTHT", "SCOR", "HL", "ACI", "OSTK", "LOGM", "OREX", "RJET", "SASR", "NM", "GFA", "DAC", "SNTA", "IDIX", "RT", "HPTX", "DEST", "CEVA", "OSIR", "JASO", "RVLT", "CMGE", "PSMI", "NATR", "NPTN", "APFC", "VLCCF", "ADNC", "WIFI", "JBSS", "CAAS", "BCRX", "SUPN", "VOCS", "BIIB", "RRC", "QIHU", "GNC", "TRQ", "RGLD", "ISIS", "QLIK", "TYL", "CRR", "ALGT", "MTH", "ABG", "ANGI", "AUQ", "LXRX", "MCP", "KEG", "PFPT", "EDMC", "NGVC", "FCF", "AIMC", "NSU", "ANV", "CTCT", "GIMO", "DNN", "DHX", "STRA", "ACRX", "BZH", "TGB", "AMRI", "RPRX", "KONG", "MXT", "RGEN", "BCOV", "OHRP", "CBR", "VRNG", "PATK", "ENPH", "ZIOP", "NAK", "LLNW", "GST", "BAA", "AVHI", "BIDU", "CF", "FBHS", "VHI", "ALK", "ARIA", "BLMN", "AWAY", "BRP", "MNKD", "MWIV", "LAD", "FIO", "OMAB", "PNK", "ITMN", "CSTE", "QLGC", "FBC", "HSTM", "STC", "DANG", "GGAL", "PCO", "MTRN", "BLDR", "SAND", "ELY", "GFIG", "FSM", "CPST", "RBY", "WTSL", "SOL", "NVAX", "SQNM", "VICR", "CYTK", "TA", "SNSS", "HCCI", "KWK", "SCMP", "IQNT", "CNBC", "YRCW", "TAX", "DRD", "AMPE", "GNE", "GG", "UAL", "DHI", "AEM", "IOC", "OIBR", "AMD", "PVR", "KCG", "IAG", "I", "FBP", "TRS", "SANM", "TILE", "CRUS", "VCI", "LGND", "NG", "EXAS", "TVL", "CWEI", "MKTG", "GDP", "CPLA", "AMAP", "RPTP", "MHO", "ZOLT", "EVC", "PES", "TEAR", "NTE", "LMOS", "PRKR", "NAVB", "RIGL", "RRMS", "OKSB", "EGAN", "TXTR", "AFFX", "NLS", "DXM", "CBK", "UNIS", "AKG", "PACR", "HBNC", "BTX", "ABX", "OKE", "PHM", "PNRA", "FSL", "GNTX", "WEN", "MTG", "YY", "MLNX", "RYL", "ACAD", "VVUS", "OLED", "ANR", "TSRO", "RMBS", "INFI", "XRS", "IPCM", "DRYS", "MTSI", "XOOM", "OPTR", "SBGL", "ABFS", "ATRS", "TC", "PPP", "IMMU", "FLWS", "DYAX", "FORM", "ONVO", "RGLS", "WG", "ACST", "AZC", "REX", "HMPR", "ZIXI", "LDK", "HZO", "TESS", "AMBI", "ATX", "CECO", "NOR", "PZG", "NNA", "TMHC", "TRIP", "HLF", "SID", "HMA", "LVNTA", "ASPS", "Z", "SUNE", "SPF", "CYOU", "SNTS", "QIWI", "CMRE", "HIMX", "HERO", "GTI", "BYD", "PVG", "UACL", "ARII", "NQ", "XONE", "AVNR", "DGICB", "GTAT", "GPRE", "SA", "BBSI", "GTN", "KNOP", "PLG", "QTM", "HCI", "ETM", "INSM", "SGYP", "STSI", "AFOP", "CTG", "VVTV", "SNBC", "NEON", "MITL", "FARM", "TNK", "VNDA", "SBCF", "FRO", "CNDO", "MHFI", "YNDX", "EXPE", "FLIR", "BVN", "SCTY", "HDS", "SBGI", "TAHO", "AGI", "MDCO", "AG", "FDML", "FLTX", "CDE", "CEL", "SONS", "SPSC", "MNTA", "HLIT", "BFR", "SZYM", "EGHT", "ESI", "MUX", "SVM", "TSRX", "QLYS", "AMAG", "XOMA", "RUTH", "MRGE", "PTCT", "MVG", "CIA", "TRX", "GTXI", "FWM", "MRCY", "VIAS", "ANIK", "BPZ", "CSS", "SILC", "TRR", "GENT", "ONCY", "ADUS", "CVGI", "SLTM", "NEM", "NWSA", "KGC", "ALKS", "CDW", "SPWR", "PDS", "MDSO", "AEGR", "PAAS", "ASGN", "MGI", "KBH", "TQNT", "MTL", "SRPT", "VHC", "TYPE", "EXEL", "LITB", "ARRY", "KERX", "EGBN", "YGE", "AAV", "SXE", "SGMO", "ECHO", "FURX", "TOWR", "TPH", "HGSH", "IMMR", "STAA", "WINA", "EDG", "TGD", "VSTM", "VICL", "SSNI", "IMI", "ACW", "STP", "GSOL", "NBBC", "CRTX", "BMRC", "ERII", "PAL", "COCO", "STX", "AUY", "GRPN", "BTU", "SSYS", "CLF", "USG", "SOHU", "MSCC", "JOBS", "HMY", "MDC", "GAME", "NIHD", "HBM", "SXC", "CRWN", "HALO", "RNA", "MM", "ICPT", "WLT", "GBLI", "CMRX", "CSIQ", "CHUY", "RLD", "ASTX", "BAS", "SPTN", "CMCO", "EXK", "RIOM", "ETB", "RCPT", "MCRI", "NAFC", "JKS", "CALL", "OMEX", "WMAR", "RSH", "ANAC", "PHX", "PRIS", "VSEC", "INO", "TGE", "FMD", "UCTT", "NFLX", "EA", "EGO", "CSGP", "YOKU", "QCOR", "YELP", "ZNGA", "VIPS", "GA", "PLCM", "PBYI", "IRWD", "RENN", "EROC", "USNA", "IRBT", "NBIX", "EZCH", "AMCC", "SXCP", "DSGX", "DNDN", "SSRI", "HWAY", "MDXG", "TSL", "KIOR", "BEBE", "ANW", "GORO", "MTRX", "HA", "COWN", "CCIX", "GHM", "CRIS", "PGNX", "HSOL", "PSUN", "CO", "DGII", "XNPT", "PLXT", "NATH", "TXMD", "MILL", "UEC", "CEMP", "KEM", "END", "GSAT", "DATE", "KNDI", "ACFN", "LEE", "ALIM", "NEO", "CLFD", "MTSN", "MFI", "GWPH", "LAWS", "IVAN", "ONFC", "REE", "STS", "TLF", "MKTO", "DM", "CYTR", "VELT", "DQ", "RGDX", "SNFCA", "SMMF", "CIMT", "CVM", "CHCI", "NTIC", "PBM", "FALC", "RWC", "ONVI", "SMSI", "CGR", "HEB", "LEDS", "TISA", "VIRC", "GAI", "PLBC", "HH", "AEY", "QMM", "OCRX", "IPDN", "PLUG", "ZBB", "ORBT", "FXEN", "CHTP", "PENX", "ANAD", "AVNW", "ANCX", "LIWA", "USU", "PME", "MSPD", "QUIK", "TTHI", "EMKR", "RMTI", "SIF", "MERU", "IKAN", "IMH", "COGO", "HNSN", "ATTU", "ALXA", "TOFC", "TST", "USAK", "MEET", "AUMN", "TIGR", "UNTY", "GRH", "CAFI", "PEIX", "NSPR", "SOCB", "CYBE", "FCVA", "IDRA", "CSUN", "DCTH", "UNTK", "SMTX", "NLST", "CMFO", "RBPAA", "CFBK", "SBBX", "API", "TPI", "DAEG", "ASTM", "CRAI", "XRM", "EAC", "OVAS", "HZNP", "ZGNX", "TSYS", "BEAT", "DWCH", "LLEN", "URZ", "ALSK", "STRI", "EMMS", "PBMD", "GNK", "SQNS", "MGPI", "FNHC", "CWTR", "EGLE", "SYN", "SSH", "BIOD", "BWEN", "RVSB", "ITI", "ETRM", "BVX", "PFSW", "AMBT", "LPHI", "THM", "FMAR", "GROW", "CSFS", "ROX", "LEI", "OVRL", "PRTS", "EMITF", "DEJ", "GIG", "YOD", "OMED", "MARK", "BLIN", "APPA", "DGLY", "HOTR", "DJCO", "CORT", "UPIP", "OME", "DGAS", "DRTX", "GALE", "OMER", "GSS", "NBS", "PTX", "HYGS", "SURG", "HPOL", "NWBO", "ETAK", "KTEC", "PSDV", "LPTN", "MLP", "OESX", "SGC", "ADK", "HDSN", "INBK", "SYPR", "TSBK", "AFFY", "FCCO", "SSN", "IRIX", "PRGN", "MATR", "RDCM", "SVNT", "INPH", "IFNY", "SEED", "MHH", "ALN", "SCOK", "ENG", "CRME", "BTUI", "CBAK", "CRDS", "SPCHB", "SHIP", "SEV", "AEHR", "BBGI", "GLUU", "GMO", "AUDC", "URG", "HNR", "MLNK", "CREG", "OCZ", "TROV", "FOLD", "PCMI", "ATAI", "PTSI", "CUR", "STRM", "DVD", "HXM", "RLJE", "GEVO", "CHLN", "WHX", "SYNM", "ENVI", "ATOS", "PXLW", "IMMY", "EPZM", "TRNS", "VRS", "USBI", "ESEA", "UPI", "DLIA", "LPR", "SKY", "IPCI", "ECTY", "DSS", "BGMD", "ONP", "VRNM", "IFMI", "ADAT", "ISR", "MSTX", "BIOF", "AFFM", "DIAL", "OCLS", "BLDP", "CRY", "PRGX", "ATNY", "IMUC", "LAS", "IVAC", "MDW", "RCKY", "CAK", "DRWI", "CTIC", "PAMT", "ZHNE", "DXYN", "HTCH", "NCTY", "CNIT", "HSON", "ADGE", "ZN", "SUTR", "MNDL", "ATV", "FCLF", "AXR", "UAMY", "EDGW", "GIGM", "HIIQ", "SVBI", "TAS", "INVE", "SGRP", "CPHC", "PSTR", "ENTA", "AEZS", "KID", "SGOC", "RECV", "RELV", "BMJ", "IBIO", "WGA", "INUV", "LUNA", "UWN", "TXCC", "MNGA", "OFLX", "DVR", "GERN", "HCKT", "FBN", "AMSC", "PLM", "MOBI", "DCIX", "ATL", "LTON", "CHC", "SNMX", "IGLD", "CCIH", "CTHR", "PBIP", "OSBC", "GALT", "AVL", "INOD", "JRCC", "VGZ", "XNY", "FCTY", "BKSC", "AETI", "ARWR", "PZZI", "SARA", "ATLC", "HTM", "VSCI", "CERE", "FBMS", "LTBR", "XPLR", "CWBC", "JSDA", "GSB", "GVP", "TBOW", "PESI", "JAG", "FFN", "PBIB", "LIME", "THTI", "IDSA", "APPY", "TTGT", "FFKT", "SIGA", "ECTE", "SWSH", "FLML", "LSG", "PCYO", "BRD", "GPL", "PTIE", "CHNR", "FRS", "BOTA", "CVTI", "URRE", "SYNC", "FRBK", "AMRB", "PTN", "CCUR", "HWBK", "REED", "BALT", "RIC", "KUTV", "ASTI", "OTIV", "CPRX", "EDAP", "GSI", "WYY", "BSDM", "QRM", "TOPS", "LOCM", "MCZ", "ROYL", "SBLK", "CYCC", "MTEX", "BONE", "RVM", "RITT", "IDI", "SPPR", "VLTC", "MGN", "FSI", "CLNT", "CIX", "SILU", "TAOM", "DRL", "CIFC", "PACB", "LINC", "IPAS", "DRRX", "DHT", "DAVE", "HIL", "CHOP", "AAU", "III", "FES", "HDY", "TEU", "IBCP", "FAC", "CACH", "DSCO", "NTS", "XRA", "RNN", "STEM", "SYMX", "MBLX", "BAXS", "NED", "GSV", "UQM", "EVK", "PRMW", "CTC", "VIMC", "ISNS", "FONR", "XPL", "TGC", "ANIP", "DGSE", "JAXB", "QTWW", "ARTX", "LPTH", "DSKX", "MICT", "DAIO", "DARA", "AMID", "SVLC", "GGS", "RALY", "MITK", "MBRG", "AXX", "FCSC", "FBMI", "PRAN", "BIOL", "PULB", "EMXX", "OCLR", "OIIM", "LPDX", "UIHC", "NEWL", "AXU", "CBLI", "CLIR", "REDF", "ZIPR", "RSOL", "ZLCS", "CBRX", "SVBL", "USEG", "CLSN", "NBY", "EGT", "WAVX", "ALCS", "CLBH", "LRAD", "COSI", "SOFO", "TSRE", "BORN", "ERB", "ASM", "SALE", "CHYR", "GLBS", "DOVR", "SDIX", "KOOL", "GPRC", "HUSA", "LBIX", "ARCI", "BDCO", "IDN", "INS", "PLCC", "CBMX", "GIGA", "CDY", "TXIC", "SINO", "NURO", "WPCS", "NEWN", "CERP", "RCAP", "CVOL", "INSY", "MGT", "TRT", "SKBI", "TSTC", "AERT", "TRUE", "BDR", "VALV", "SCEI", "AMTY", "EONC", "DIGA", "DEAR", "NUGT", "TLR", "OPHC", "CDTI", "GNBT", "RMKR", "CXM", "SCKT", "SPEX", "GMET", "PURE", "EPCT", "OXBT", "HEAT", "FREE", "GLDX", "TELOZ", "KBX", "TRIT", "BLUE", "ATEA", "CJJD", "AMCO", "CAST", "QKLS", "ATGN", "CHGS", "TNGN", "ALVR", "UVXY", "GDXJ", "DLGC", "MEIL", "CRMD", "DYSL", "MACE", "GTIM", "LOAN", "TELK", "CADC", "ABIO", "NFEC", "CELM", "ALSE", "UGAZ", "GDX", "STXS", "MGH", "OSN", "CNET", "BNSO", "CLRX", "ULGX", "PGRX", "MKTY", "RNIN", "DEER", "MRNA", "FTBK", "TVIX", "GASX", "VSCP", "IGC", "CALI", "EFOI", "JOB", "CELH", "HRT", "GNVC", "NSTG", "BCAR", "GPR", "SPIR", "NLTX", "TDN", "GASL", "THST", "SCON", "MBIS", "ELMD", "IFON", "BSPM", "OINK", "DRAM", "DPW", "ONSM", "CDII", "PBIO", "CVBK", "SOXS", "DUST", "HPJ", "AMS", "OPXA", "AQQ", "ABCW", "LIVE", "AMCF", "OXGN", "TBAC", "ORCT", "ABMC", "TDBK", "DVOX", "SOXL", "DRN", "ASTC", "SCIL", "ZOOM", "CPHI", "PETX", "HIHO", "VBFC", "EMIS", "ATRM", "FSGI", "KONE", "MYRX", "WEST", "SIFY", "DGAZ", "AAPL", "ABT", "ACT", "AGN", "AIG", "AMAT", "AMGN", "AMZN", "AVB", "AZO", "BA", "BBY", "BCR", "BEN", "BMY", "BRK-B", "BXP", "C", "CELG", "CHK", "CL", "CMCSA", "CMI", "COST", "CRM", "CSCO", "CSX", "CVX", "DIS", "DVA", "EBAY", "EMC", "EOG", "FB", "FCX", "FDX", "FFIV", "FITB", "FLS", "GE", "GILD", "GLW", "GOOG", "GS", "GWW", "HAL", "HPQ", "IBM", "ICE", "INTC", "ISRG", "JCP", "JNJ", "JPM", "KMB", "KO", "LMT", "LO", "LOW", "MA", "MCD", "MCK", "MET", "MMM", "MO", "MON", "MRK", "MS", "MSFT", "MTB", "NBL", "NVDA", "ORCL", "ORLY", "PCLN", "PCP", "PFE", "PG", "PPG", "PSA", "PX", "PXD", "QCOM", "RL", "ROP", "SCHW", "SHW", "SPG", "SPLS", "SRCL", "SYMC", "T", "TWC", "TXN", "UNP", "USB", "V", "VFC", "VLO", "VZ", "WFC", "WHR", "WMT", "WPO", "WU", "WYNN", "X", "XOM", "YHOO", "A", "AA", "ABC", "ACE", "ADBE", "ADI", "ADM", "ADP", "ADSK", "AEE", "AEP", "AES", "AET", "AFL", "AIV", "AIZ", "AKAM", "AKS", "ALL", "ALTR", "AMP", "AMT", "AN", "ANF", "AON", "APA", "APC", "APD", "APH", "APOL", "ARG", "ATI", "AVP", "AVY", "AXP", "AZN", "BAC", "BAX", "BBBY", "BBT", "BDX", "BF-b", "BHI", "BIG", "BK", "BLL", "BMC", "BMS", "BRCM", "BSX", "CA", "CAG", "CAH", "CAM", "CAT", "CB", "CBG", "CBS", "CCE", "CCL", "CERN", "CFN", "CHRW", "CI", "CINF", "CLX", "CMA", "CME", "CMS", "CNP", "CNX", "COF", "COG", "COH", "COL", "COP", "COV", "CPB", "CPWR", "CSC", "CTAS", "CTL", "CTSH", "CTXS", "CVC", "CVH", "CVS", "D", "DD", "DE", "DELL", "DF", "DFS", "DGX", "DHR", "DISCA", "DNB", "DNKN", "DNR", "DO", "DOV", "DOW", "DPS", "DRI", "DTE", "DTV", "DUK", "DV", "DVN", "ECL", "ED", "EFX", "EIX", "EL", "EMN", "EMR", "EQR", "EQT", "ESRX", "ETFC", "ETN", "ETR", "EXC", "EXPD", "F", "FAST", "FDO", "FE", "FHN", "FII", "FIS", "FISV", "FLR", "FMC", "FRX", "FSLR", "FTI", "FTR", "GAS", "GCI", "GD", "GIS", "GME", "GNW", "GPC", "GPS", "GSK", "GT", "HAR", "HAS", "HBAN", "HCBK", "HCN", "HCP", "HD", "HES", "HIG", "HOG", "HON", "HOT", "HP", "HRB", "HRL", "HRS", "HSP", "HST", "HSY", "HUM", "IFF", "IGT", "INTU", "IP", "IPG", "IR", "IRM", "ITT", "ITW", "IVZ", "JBL", "JCI", "JDSU", "JEC", "JNPR", "JNS", "JWN", "K", "KEY", "KIM", "KLAC", "KMX", "KR", "KSS", "L", "LEG", "LEN", "LH", "LIFE", "LLL", "LLTC", "LLY", "LM", "LNC", "LSI", "LTD", "LUK", "LUV", "LXK", "M", "MAR", "MAS", "MAT", "MCHP", "MCO", "MDT", "MHP", "MJN", "MKC", "MMC", "MMI", "MOLX", "MRO", "MSI", "MUR", "MWV", "MWW", "MYL", "NBR", "NDAQ", "NE", "NEE", "NFX", "NI", "NKE", "NOC", "NOV", "NRG", "NSC", "NSM", "NTAP", "NTRS", "NU", "NUE", "NVS", "NWL", "NYX", "OI", "OMC", "OXY", "PAYX", "PBCT", "PBI", "PCAR", "PCG", "PCL", "PDCO", "PEG", "PEP", "PFG", "PGR", "PH", "PKI", "PLD", "PLL", "PM", "PNC", "PNW", "POM", "PPL", "PRU", "PWR", "QEP", "R", "RAI", "RDC", "RF", "RHHBY", "RHI", "RHT", "ROK", "ROST", "RRD", "RSG", "RTN", "SAI", "SBUX", "SCG", "SE", "SEE", "SHLD", "SIAL", "SJM", "SLB", "SLM", "SNA", "SNDK", "SNI", "SNY", "SO", "SRE", "STI", "STJ", "STT", "STZ", "SVU", "SWK", "SWN", "SWY", "SYK", "SYY", "TAP", "TDC", "TE", "TEG", "TER", "TEVA", "TGT", "THC", "TIE", "TIF", "TJX", "TLAB", "TMK", "TMO", "TROW", "TRV", "TSN", "TSO", "TSS", "TWX", "TXT", "TYC", "UNH", "UNM", "UPS", "URBN", "UTX", "VAR", "VIAb", "VMC", "VNO", "VRSN", "VTR", "WAG", "WAT", "WDC", "WEC", "WFR", "WIN", "WLP", "WM", "WMB", "WY", "WYN", "XEL", "XL", "XLNX", "XRAY", "XRX", "YUM", "ZION", "ZMH", "NWS", "LINE", "LNCO", "TSLA", "EBIX", "ALXN", "GMCR", "WETF", "BBEP", "SODA", "THRX", "GPOR", "BBRY", "INCY", "DWA", "CTRP", "NPSP", "SCSS", "VRTX", "SGEN", "GOLD", "ARUN", "BMRN", "CAR", "CY", "SINA", "SWFT", "AGNC", "ARCP", "ADTN", "MYGN", "CIEN", "FTNT", "EXXI", "TTWO", "LEAP", "ILMN", "MPEL", "CREE", "HOLX", "SWKS", "MTGE", "FNSR", "MDRX", "EQIX", "FWLT", "SQQQ", "SPLK", "ATVI", "CHTR", "SWHC", "TQQQ", "FULT", "TIBX", "FMER", "DISH"]
sp500 = ["ABT", "ABBV", "ACE", "ACN", "ACT", "ADBE", "ADT", "AES", "AET", "AFL", "A", "GAS", "APD", "ARG", "AKAM", "AA", "ALXN", "ATI", "ALLE", "AGN", "ADS", "ALL", "ALTR", "MO", "AMZN", "AEE", "AEP", "AXP", "AIG", "AMT", "AMP", "ABC", "AME", "AMGN", "APH", "APC", "ADI", "AON", "APA", "AIV", "AAPL", "AMAT", "ADM", "AIZ", "T", "ADSK", "ADP", "AN", "AZO", "AVB", "AVY", "AVP", "BHI", "BLL", "BAC", "BK", "BCR", "BAX", "BBT", "BEAM", "BDX", "BBBY", "BMS", "BRK.B", "BBY", "BIIB", "BLK", "HRB", "BA", "BWA", "BXP", "BSX", "BMY", "BRCM", "BF.B", "CHRW", "CA", "CVC", "COG", "CAM", "CPB", "COF", "CAH", "CFN", "KMX", "CCL", "CAT", "CBG", "CBS", "CELG", "CNP", "CTL", "CERN", "CF", "SCHW", "CHK", "CVX", "CMG", "CB", "CI", "CINF", "CTAS", "CSCO", "C", "CTXS", "CLX", "CME", "CMS", "COH", "KO", "CCE", "CTSH", "CL", "CMCSA", "CMA", "CSC", "CAG", "COP", "CNX", "ED", "STZ", "GLW", "COST", "COV", "CCI", "CSX", "CMI", "CVS", "DHI", "DHR", "DRI", "DVA", "DE", "DLPH", "DAL", "DNR", "XRAY", "DVN", "DO", "DTV", "DFS", "DISCA", "DG", "DLTR", "D", "DOV", "DOW", "DPS", "DTE", "DD", "DUK", "DNB", "ETFC", "EMN", "ETN", "EBAY", "ECL", "EIX", "EW", "EA", "EMC", "EMR", "ESV", "ETR", "EOG", "EQT", "EFX", "EQR", "ESS", "EL", "EXC", "EXPE", "EXPD", "ESRX", "XOM", "FFIV", "FB", "FDO", "FAST", "FDX", "FIS", "FITB", "FSLR", "FE", "FISV", "FLIR", "FLS", "FLR", "FMC", "FTI", "F", "FRX", "FOSL", "BEN", "FCX", "FTR", "GME", "GCI", "GPS", "GRMN", "GD", "GE", "GGP", "GIS", "GM", "GPC", "GNW", "GILD", "GS", "GT", "GOOG", "GOOGL", "GWW", "HAL", "HOG", "HAR", "HRS", "HIG", "HAS", "HCP", "HCN", "HP", "HES", "HPQ", "HD", "HON", "HRL", "HSP", "HST", "HCBK", "HUM", "HBAN", "ITW", "IR", "TEG", "INTC", "ICE", "IBM", "IGT", "IP", "IPG", "IFF", "INTU", "ISRG", "IVZ", "IRM", "JBL", "JEC", "JNJ", "JCI", "JOY", "JPM", "JNPR", "KSU", "K", "KEY", "GMCR", "KMB", "KIM", "KMI", "KLAC", "KSS", "KRFT", "KR", "LB", "LLL", "LH", "LRCX", "LM", "LEG", "LEN", "LUK", "LLY", "LNC", "LLTC", "LMT", "L", "LO", "LOW", "LSI", "LYB", "MTB", "MAC", "M", "MMM", "MRO", "MPC", "MAR", "MMC", "MAS", "MA", "MAT", "MKC", "MCD", "MHFI", "MCK", "MJN", "MWV", "MDT", "MRK", "MET", "MCHP", "MU", "MSFT", "MHK", "TAP", "MDLZ", "MON", "MNST", "MCO", "MS", "MOS", "MSI", "MUR", "MYL", "NBR", "NDAQ", "NOV", "NTAP", "NFLX", "NWL", "NFX", "NEM", "NWSA", "NEE", "NLSN", "NKE", "NI", "NE", "NBL", "JWN", "NSC", "NTRS", "NOC", "NU", "NRG", "NUE", "NVDA", "KORS", "ORLY", "OXY", "OMC", "OKE", "ORCL", "OI", "PCG", "PCAR", "PLL", "PH", "PDCO", "PAYX", "BTU", "PNR", "PBCT", "POM", "PEP", "PKI", "PRGO", "PETM", "PFE", "PM", "PSX", "PNW", "PXD", "PBI", "PCL", "PNC", "RL", "PPG", "PPL", "PX", "PCP", "PCLN", "PFG", "PG", "PGR", "PLD", "PRU", "PEG", "PSA", "PHM", "PVH", "QEP", "PWR", "QCOM", "DGX", "RRC", "RTN", "RHT", "REGN", "RF", "RSG", "RAI", "RHI", "ROK", "COL", "ROP", "ROST", "RDC", "R", "SWY", "CRM", "SNDK", "SCG", "SLB", "SNI", "STX", "SEE", "SRE", "SHW", "SIAL", "SPG", "SLM", "SJM", "SNA", "SO", "LUV", "SWN", "SE", "STJ", "SWK", "SPLS", "SBUX", "HOT", "STT", "SRCL", "SYK", "STI", "SYMC", "SYY", "TROW", "TGT", "TEL", "TE", "THC", "TDC", "TSO", "TXN", "TXT", "HSY", "TRV", "TMO", "TIF", "TWX", "TWC", "TJX", "TMK", "TSS", "TSCO", "RIG", "TRIP", "FOXA", "TSN", "TYC", "USB", "UNP", "UNH", "UPS", "X", "UTX", "UNM", "URBN", "VFC", "VLO", "VAR", "VTR", "VRSN", "VZ", "VRTX", "VIAB", "V", "VNO", "VMC", "WMT", "WAG", "DIS", "GHC", "WM", "WAT", "WLP", "WFC", "WDC", "WU", "WY", "WHR", "WFM", "WMB", "WIN", "WEC", "WYN", "WYNN", "XEL", "XRX", "XLNX", "XL", "XYL", "YHOO", "YUM", "ZMH", "ZION", "ZTS"]
base_url = "http://ichart.finance.yahoo.com/table.csv?s="
back_url = "&a=0&b=01&c=1900&d=0&e=01&f=2014&g=d"

def make_url(ticker_symbol):
	return base_url + ticker_symbol + back_url

def retve(gene):
	passes = 0
	while (passes == 0):
		try:
			urllib.urlretrieve(make_url(gene), gene+".csv")
			passes += 1
		except IOError:
			print "hacking at connection"
			pass
	print gene + " done"
	return 0

if __name__ == '__main__':
	#use multiprocessing to evalulate likelihood
	pool = Pool(4)
	result = pool.map_async(retve,sp500)
	result.wait()

